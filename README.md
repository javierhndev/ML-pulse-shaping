# ML pulse shaping
In this repository we keept the code to reproduce the ML paper for pulse shaping.

# Requirements
you can build a Python virtual environment using the `requirements.txt`. There is no stric version requirement but I explicitly keep the versions for reproducibility. CUDA (GPU) in Pytorch is not required although it will help to speed up the training.

# Data extraction

All data used to train/test model is stored in the `datasets` folder.

Most of the files contain just the pulse shape and Dazzler imputs:
- `pulse_and_dazzler_240918.h5`: It is the main dataset, used form most modeling.
- `pulse_and_dazzler_250313.h5`: It is used in the forward model section to study the impact of different days.
- `pulse_and_dazzler_240520b.h5`: In the custom pulse shape section, it is the initial dataset used to train the models.
- `pulse_and_dazzler_250520b_pred.h5`: It is the experiumental results after using the ML models in the custom pulse shape section.

 **Optional**: To generate such datasets, one can use the `data_generation.py` which uses raw data extracted from *GALADRIEL* with the `writing_dataset_and_goodness.py` Python script. The latter needs to be executed in the Galadriel server and requires an account and the `galadriel_db.py` module (which imports all the calls to MORIA).

Additionally, the `2024_09_18_physicsrun - 20240918_inshot_tempcorrected.csv` is a database generated by Gil from a physics run on 240918. It is used oly to motivate the paper and to show the increase of energy (or particle count) for some values of the Dazzler.

# Forward modeling

Use the `forwad_models.ipynb` notebook to recreate the results from the Forward modeling section

# Roundtrip modeling

Use the `roundtrip_models.ipynb` notebooks to recreate the results from the Roundtrip modeling section

# Custom pulse shaping

Use the `custom_pulse_shaping.ipynb` notebooks to recreate the results from the Custom pulse shaping section
