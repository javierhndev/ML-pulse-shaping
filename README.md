# ML pulse shaping
In this repository we keept the code to reproduce the ML paper for pulse shaping.

# Requirements
you can build a Python virtual environment using the `requirements.txt`. There is no stric version requirement but I explicitly keep the versions for reproducibility. CUDA (GPU) in Pytorch is not required although it will help to speed up the training.

# Data extraction

Most of the modeling is trained on the `datasets/pulse_and_dazzler_240918.h5` dataset. It contains the pulse shapes and Dazzler inputs from the `240918` dataset. **Optional**: To generate such dataset, one can use the `data_generation.py` which uses raw data extracted from *GALADRIEL* with the `writing_dataset_and_goodness.py` Python script. The latter needs to be executed in the Galadriel server and requires an account and the `galadriel_db.py` module (which imports all the calls to MORIA).

The `datasets/pulse_and_dazzler_250313.h5` dataset is used to stuy the impact from other days. It is stored in this repository but can be generated following the same approach described in the above paragraph.

The `2024_09_18_physicsrun - 20240918_inshot_tempcorrected.csv` is a database generated by Gil from a physics run on 240918. It is used oly to motivate the paper and to show the increase of energy (or particle count) for some values of the Dazzler.

# Forward modeling

Use the `forwad_models.ipynb` notebook to recreate the results from the Forward modeling section

# Roundtrip modeling

Use the `roundtrip_models.ipynb` notebooks to recreate the results from the Roundtrip modeling section
